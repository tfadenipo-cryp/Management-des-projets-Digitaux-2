image: python:3.13-slim

stages:
  - lint
  - typecheck
  - audit
  - test

before_script:
  - pip install uv pip-audit
  - uv sync --frozen

lint:
  stage: lint
  script:
    - uv run ruff check src/

typecheck:
  stage: typecheck
  script:
    - uv run mypy src/ --ignore-missing-imports

security-audit:
  stage: audit
  script:
    - pip-audit

pytest:
  stage: test
  script:
    - uv run pytest tests/